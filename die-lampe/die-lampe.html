<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../flowbased-polymer/mixin.html">

<dom-module id="die-lampe">
  <template>
    <style>
      :host {
        display: inline-block;
        width: 90px;
        height: 90px;
        margin: 10px;
        --main-lamp-color: #FFFF00;
        --disabled-lamp-color: #848484;
        --helligkeit: 1;
      }

      div {
        width: 100%;
        height: 100%;
        box-sizing: border-box;
        margin: 12px;
        background-color: transparent;
        border-radius: 50px;
        box-shadow: 0 0 18px var(--disabled-lamp-color), inset 0 0 18px var(--disabled-lamp-color);
        opacity: var(--helligkeit);
      }

      div[enabled] {
        background-color: var(--main-lamp-color);
        box-shadow: 0 0 18px var(--main-lamp-color), inset 0 0 18px var(--main-lamp-color);
        -webkit-animation: pulse 2s linear 1s infinite;
      }

      @-webkit-keyframes pulse {
        0% {
          box-shadow: 0 0 18px var(--main-lamp-color), inset 0 0 18px var(--main-lamp-color);
        }
        50% {
          box-shadow: 0 0 16px var(--main-lamp-color), inset 0 0 14px var(--main-lamp-color);
        }
        100% {
          box-shadow: 0 0 18px var(--main-lamp-color), inset 0 0 18px var(--main-lamp-color);
        }
      }
    </style>
    <div enabled$="[[brennt]]"></div>
  </template>

  <script>
    /**
     * `die-lampe`
     * Eine Simulation einer Lampe
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class DieLampe extends FBPMixin(Polymer.Element) {
      static get is() {
        return 'die-lampe';
      }

      static get properties() {
        return {
          /**
           * Ist die Lampe eingeschaltet?
           * brennt ist true wenn die Lampe brennt!
           *
           */
          brennt: {
            type: Boolean,
            readOnly: true,
            reflectToAttribute: true,
            value: false

          },
          /**
           * Setzt die Farbe der Lampe
           *
           */
          farbe: {
            type: String,
            notify: true,
            observer: "setzeFarbe",
            value: "#ead03c",
          },
          /**
           * Setze die Helligkeit der Lampe
           */
          helligkeit: {
            type: String,
            notify: true,
            observer: "setHelligkeit",
            value: 1,
          },
        };
      }

      /**
       * Setze eine andere Farbe für die Lampe
       * @param color
       */
      setzeFarbe(color) {
        this.style.setProperty('--main-lamp-color', color);
      }

      /**
       * Setze die Helligkeit
       * 0 - 1 für % der Helligkeit
       * >1 - 100 für % der Helligkeit
       *
       * @param helligkeit
       */
      setHelligkeit(helligkeit) {
        if (helligkeit > 1) {
          helligkeit = helligkeit / 100
        }
        this.style.setProperty('--helligkeit', helligkeit);
      }

      /**
       * Schaltet ein wenn sie aus war und aus wenn sie ein war.
       */
      umschalten() {
        this._setBrennt(!this.brennt);
      }

      /**
       * Schaltet die Lampe ein
       */
      ein() {
        this._setBrennt(true);
      }

      /**
       * Schaltet die Lampe aus
       */
      aus() {
        this._setBrennt(false);
      }
    }


    window.customElements.define(DieLampe.is, DieLampe);
  </script>
</dom-module>
